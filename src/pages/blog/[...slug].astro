---
import { type CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";
import ContactSection from "../../components/ContactForm.astro"

import FormattedDate from '../../components/FormattedDate.astro';
import BackBt from "../../components/BackBt.astro";

export async function getStaticPaths() {
    const blog = await getCollection("blog");
    return blog.map((blog) => ({
        params: { slug: blog.slug },
        props: blog,
    }));
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await post.render();


import "../../styles/blog/blog.css"
import "../../styles/blog/post.css"

import { Schema } from "astro-seo-schema"
import EndingBlogNav from "../../components/EndingBlogNav.astro";

const posts = (await getCollection('blog')).sort(
	(a, b) =>  b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

---

<Layout {...post.data} title={post.data.title}>
    <section class="intro">
        <BackBt url={`/blog/#${(post.data.title).toLowerCase().replace(/\s+/g, '-')}`} label="Return"/>

        <div class="cover">
			<img src={post.data.heroImage} alt={post.data.description} loading="lazy" draggable="false" class="reveal_delay"/>
		</div>

        <!-- <img src={post.data.image} alt={`Photo of ${post.data.title} cleaning service`}> -->

        <!-- <hr> -->
    
    </section>

    <div class="content_ctnr">
        <article class="reveal">
            <div class="over_heading">
                <div class="author">{post.data.authorImage ? (<img src={post.data.authorImage} alt={`${post.data.author} profile picture`}/>) : "by"} <cite>{post.data.author}</cite></div>
    
                <hr/>

				<FormattedDate date={post.data.pubDate} />
            </div>
    
            <h1>{post.data.title}</h1>
    
            {post.data.tags ? (
                <ul class="tags">
                    {post.data.tags.map(item => (
                        <li>
                            {item == "Bathroom" ? (
                                <a href={`/services/bathrooms`} class="reveal_tag">{item}</a>
                            ) : (
                                <p class="reveal_tag">{item}</p>
                            )}
                        </li>
                    ))}
                </ul>
            ) : null}

            <div class="post_content">
                {post.data.standFirst ? (
                    <p class="standfirst">{post.data.standFirst}</p>

                    <hr/>
                ) : null}

                <Content />
            </div>
        </article>

        <div class="cta_ctnr">
            <a href="/contact/" class="main cta" aria-label="Get a free quote for our cleaning services">Get a free quote</a>
        </div>
    </div>

    <!-- <EndingBlogNav category={post.data.category}/> -->

    <ContactSection />

    <Schema
        item={{
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            headline: `${post.data.title}`,
            image: `${post.data.heroImage}`,
            "author": [{
                "@type": "Person",
                "name": "Samit Patel"
            }],
            "publisher": {
                "@type": "Organization",
                "name": "Samit Patel",
                "logo": {
                    "@type": "ImageObject",
                    "url": "/logo/tcn-logo-360.png"
                }
            }
        }}
    />
</Layout>